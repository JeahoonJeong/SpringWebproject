<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="searchMapper">

<!-- 책 검색 리스트 -->
<select id="getSearchBook" parameterType="hashMap" resultType="com.spring.webproject.dto.SearchDTO">
 select * from(
 select rownum rnum,data.* from(
 select a.isbn,a.booktitle,a.subtitle,a.publisher,a.publishDate,a.bookprice,b.authorName, c.bookImage
 from books a, author b, bookimage c
 where a.booktitle like '%' || #{searchValue} || '%' and
 b.authorId = a.authorId and c.bookimage like '%cover%' and a.isbn = c.isbn  ) data)
 <![CDATA[
 where rnum>=#{start} and rnum<=#{end}  
 ]]>
</select>



<!-- 책 검색 데이터 갯수 -->
<select id="getBookCount" parameterType="hashMap"  resultType="int">
 select nvl(count(*),0) from books 
 where booktitle like '%' || #{searchValue} || '%'
</select>

<!-- 자동검색 -->
<select id="getBookTitle" parameterType="hashMap" resultType="com.spring.webproject.dto.SearchDTO">
 select booktitle from books
 where booktitle like '%' || #{searchValue} || '%' 
</select>



</mapper>